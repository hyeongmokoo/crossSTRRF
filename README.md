# A Cross-Space-Time Relative Risk Function

Space-time kernel density estimation (STKDE) commonly is used for space-time cluster detection. But, this technique might be limited because it does not take into account an underlying population at risk for observed events. A space-time relative risk function (STRRF) can help overcome this limitation by allowing a comparison of each kernel density of observations with that of controls. This repository provides the sample code for a cross-STRRF to identify spatio-temporal locations that experience statistically significant changes in their density of events. With events organized in a space-time voxel structure, the cross-STRRF evaluates space-time patterns by comparing event occurrences at a spatial location in a previous time period with ones in its future as well as with its spatial neighbors in its contemporaneous time period. The test statistics of the cross-STRRF values in each voxel are obtained with a permutation test in which cases and controls are shuffled within each time period to maintain the space-time envelope of events. The figure files (voxler format) included in this repository shows the an application to assault crime incidents in the city of Plano, Texas between 2008 and 2012. It illustrates that the cross-STRRF and its significance test results emphasize spatio-temporal changes in event density rather than constantly focusing on high density regions, which STKDE does.

The reference for the cross STRRF appears in [Koo et al. (2019)](https://www.tandfonline.com/doi/abs/10.1080/15230406.2019.1641149).
- Koo, H., Lee, M., Chun, Y., and Griffith, D. A., 2019, Space-time cluster detection with cross-space-time relative risk functions, Cartography and Geographic Information Science, (advance online publication).
